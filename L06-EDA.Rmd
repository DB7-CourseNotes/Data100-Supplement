---
title: "L06: Exploratory Data Analysis"
subtitle: "Chapters XXXin R4DS"
author: "Devan Becker"
output: pdf_document
---

```{r}
library(tidyverse)
library(ggrepel) # Might need to run install.packages("ggrepel") in the console
```

## Potential Solutions to P05

The goal: What should I look for if I want a fuel efficient car?

Some possible summary statistics:

```{r}
mpg_imp <- mpg |>
    mutate(overall = 0.45 * hwy + 0.55 * cty,
           cyl = factor(cyl)) 

mpg_imp |>
    group_by(cyl, fl, class) |>
    summarise(
        mean_overall = mean(overall),
        top_ten_percentile = quantile(overall, 0.90)
    ) |>
    arrange(desc(mean_overall))
```


Some possible plots:

```{r}
ggplot(mpg_imp) +
    aes(x = displ, y = overall, colour = cyl) +
    geom_point()
```

Looks like I want a small engine, 4 cylinder car.

```{r}
ggplot(mpg_imp) +
    aes(x = class, y = overall, fill = drv) +
    geom_boxplot()
```

So it looks like 4 cylinder compact, midsize, and subcompact front wheel drive cars have the highest overall fuel efficiency. Let's only look at those cars:

```{r}
mpg_imp |>
    filter(
        cyl == 4, drv == "f",
        class %in% c("compact", "midsize", "subcompact")
    ) |>
    ggplot() +
        aes(x = trans, y = overall) +
        geom_boxplot()
```

No clear conclusions about the transmission. Let's look at more summary stats.

```{r}
mpg_imp |>
    filter(
        cyl == 4, drv == "f",
        class %in% c("compact", "midsize", "subcompact")
    ) |>
    group_by(class) |>
    summarise(mean(overall), quantile(overall, 0.9))

```




## Diamonds


Let's explore some data! What influences the price of a diamond? 

- Probably it's size?
- Shape?
- Overall quality?

## Getting Used to the Data

```{r}
library(tidyverse)
library(ggrepel)
glimpse(diamonds)
```

Plots always show the most information about the data. Let's plot things!

### Categorical Variables

```{r}
ggplot(diamonds) +
    aes(x = cut) +
    geom_bar()
```

Some comments:

- 
- 
- 
- 
- 
- 
- 

We can also look at some summary statistics:

```{r}
diamonds |>
    summarise(
        smallest_carat = min(carat),
        distinct_colors = n_distinct(color),
        distinct_cuts = n_distinct(cut),
        distinct_cuts_colors = n_distinct(color, cut)
    )
```

### Numeric Variables

```{r}
ggplot(diamonds) +
    aes(x = carat) + 
    geom_histogram()
```

Comments:

- 
- 
- 
- 
- 
- 
- 

## Bivariate Explorations

```{r}
ggplot(diamonds) +
    aes(x = clarity, fill = cut) +
    geom_bar(position = "dodge")
```

Comments:

- 
- 
- 
- 
- 

```{r}
ggplot(diamonds) +
    aes(x = x, y = y) +
    geom_point()
```

Comments:

- There are some outliers - what's up with that? Let's use `filter()` to find out.

```{r echo=FALSE}
(outliers_xy <- diamonds 
    # YOUR CODE HERE
)
```


Let's make a plot where these points are labelled:

```{r}
outlier_xy_labels <- labs(
    x = "Width of Diamond",
    y = "Height of Diamond",
    title = "What's going on with the outliers?"
)

# Need ggrepel library to be loaded
(label_outlier_plot <- diamonds |>
    filter(
        # filter out the outliers    
        # YOUR CODE HERE
    ) |>
    # Make the same plot as before
    # YOUR CODE HERE
    geom_label_repel(
        # Add a label for the diamonds in outliers_xy
        # YOUR CODE HERE
    ) +
    geom_point(
        data = outliers_xy,
        colour = "red"
    ) +
    outlier_xy_labels
)
```


The code above is a little verbose. There's a much more concise way to do this:

```{r}
diamonds |>
    mutate(
        outlier = ifelse(
            # YOUR CODE HERE
        )
    ) |>
    ggplot() +
        # YOUR CODE HERE
```

### But what about the other columns?

```{r}
ggplot(diamonds) +
    aes(x = x, fill = clarity) +
    geom_density() +
    facet_wrap(~ cut)
```

```{r}
diamonds |>
    group_by()
    summarise()
```

Comments:

- 
- 
- 
- 
- 
- 
- 


